

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tensor and Observed Tensor &mdash; Sknet alpha.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'alpha.1',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="sknet.dataset" href="../dataset.html" />
    <link rel="prev" title="sknet" href="../base.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Sknet
          

          
          </a>

          
            
            
              <div class="version">
                1.8.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../user/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/dataset.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/preprocess.html">Preprocess</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/network.html">Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/schedule.html">Schedules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/pipeline.html">Pipeline</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../base.html"><code class="docutils literal notranslate"><span class="pre">sknet</span></code></a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tensor and Observed Tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#worker-and-workergroup">Worker and WorkerGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dataset.html"><code class="docutils literal notranslate"><span class="pre">sknet.dataset</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ops.html"><code class="docutils literal notranslate"><span class="pre">sknet.ops</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../layers.html"><code class="docutils literal notranslate"><span class="pre">sknet.layers</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../network.html"><code class="docutils literal notranslate"><span class="pre">sknet.network</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimize.html"><code class="docutils literal notranslate"><span class="pre">sknet.optimize</span></code></a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Sknet</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../base.html"><code class="docutils literal notranslate"><span class="pre">sknet</span></code></a> &raquo;</li>
        
      <li>Tensor and Observed Tensor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/modules/base/base.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tensor-and-observed-tensor">
<h1>Tensor and Observed Tensor<a class="headerlink" href="#tensor-and-observed-tensor" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="sknet.Tensor">
<em class="property">class </em><code class="descclassname">sknet.</code><code class="descname">Tensor</code><span class="sig-paren">(</span><em>tensor_or_func=None</em>, <em>shape=None</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/RandallBalestriero/Sknet/valpha.1/sknet.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sknet.Tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Overloading the <code class="xref py py-class docutils literal notranslate"><span class="pre">tf.Tensor</span></code></p>
</dd></dl>

<dl class="class">
<dt id="sknet.ObservedTensor">
<em class="property">class </em><code class="descclassname">sknet.</code><code class="descname">ObservedTensor</code><span class="sig-paren">(</span><em>tensor</em>, <em>observation=None</em>, <em>teacher_forcing=None</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/RandallBalestriero/Sknet/valpha.1/sknet.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sknet.ObservedTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Tensor with dual behavior</p>
<p>This tensor is doing</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>tensor</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tf.Tensor</span></dt>
<dd><p class="first last">the tensor to equip with dual behavior</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="worker-and-workergroup">
<h1>Worker and WorkerGroup<a class="headerlink" href="#worker-and-workergroup" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="sknet.Worker">
<em class="property">class </em><code class="descclassname">sknet.</code><code class="descname">Worker</code><span class="sig-paren">(</span><em>*args</em>, <em>context</em>, <em>to_print=[]</em>, <em>feed_dict={}</em>, <em>name=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/RandallBalestriero/Sknet/valpha.1/sknet.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sknet.Worker" title="Permalink to this definition">¶</a></dt>
<dd><p>processing unit that manages tensorflow ops executation, output saving
and printing.
A Worker allows to specify a context, such as train set, test set, or any
context present in a datset, and tensorflow ops to be executed, and if the
deep net behavior should be deterministic or not (for example during
testing). The ops are given as kwargs of the function, the names used will
be the same used for saving (think of <code class="xref py py-class docutils literal notranslate"><span class="pre">np.savez</span></code>. For more control
it is possible to give a couple where the second item is a function that
takes for input a batch number and epoch number. This allow further
control if one wants to only execute an op every X batch or only after the
10th epoch and so on. Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># an op updating the dn weight</span>
<span class="n">update_</span> <span class="n">op</span> <span class="o">=</span> <span class="o">...</span>
<span class="c1"># an op measuring the accuracy on each batch</span>
<span class="n">accu</span> <span class="o">=</span> <span class="o">...</span>
<span class="c1"># an op measuring the average accuracy over all batches on the set</span>
<span class="n">avg_accu</span> <span class="o">=</span> <span class="n">sknet</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">streaming_mean</span><span class="p">(</span><span class="n">accu</span><span class="p">)</span>
<span class="c1"># a tensor which is a weight of the Dn that we wish to monitor</span>
<span class="c1"># and we want to monitor it only at the first batch of epoch 0, 10, 15</span>
<span class="n">W</span> <span class="o">=</span> <span class="o">....</span>
<span class="k">def</span> <span class="nf">fW</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">epoch</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">batch</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># we now create the worker</span>
<span class="n">worker</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">context</span> <span class="o">=</span> <span class="s1">&#39;train_set&#39;</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">update</span> <span class="o">=</span> <span class="n">update_op</span><span class="p">,</span> <span class="n">accu</span><span class="o">=</span><span class="n">accu</span><span class="p">,</span> <span class="n">avg_accu</span> <span class="o">=</span> <span class="n">avg_accu</span><span class="p">,</span>
                <span class="n">W</span><span class="o">=</span><span class="p">(</span><span class="n">dnn</span><span class="o">.</span><span class="n">W</span><span class="p">,</span><span class="n">fW</span><span class="p">))</span>
</pre></div>
</div>
<p>with the above example (notice that the index starts at 0), the worker
will execute on the train set (in parallel at each batch) all the given
and for the weight monitoring, will only save the output if the conditioin
if fulfilled. The update op, as obtained from a tensorflow operation
returns None values. This will not be saved by the worker. Hence, at the
end of an epoch. The data saved in <code class="docutils literal notranslate"><span class="pre">`worker.epoch_data`</span></code> will be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worker</span><span class="o">.</span><span class="n">epoch_data</span><span class="p">[</span><span class="s1">&#39;update&#39;</span><span class="p">]</span> <span class="c1"># an empty list</span>
<span class="n">worker</span><span class="o">.</span><span class="n">epoch_data</span><span class="p">[</span><span class="s1">&#39;accu&#39;</span><span class="p">]</span> <span class="c1"># array of shape (N_EPOCH, N_BATCH,1)</span>
<span class="n">worker</span><span class="o">.</span><span class="n">epoch_data</span><span class="p">[</span><span class="s1">&#39;avg_accu&#39;</span><span class="p">]</span> <span class="c1"># array of shape (N_EPOCH, 1), there are</span>
                              <span class="c1"># no batch dimension when using</span>
                              <span class="c1"># streaming tensors as they compute</span>
                              <span class="c1"># aggregated stats. over all batches of</span>
                              <span class="c1"># each epoch</span>
<span class="n">worker</span><span class="o">.</span><span class="n">epoch_data</span><span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">]</span> <span class="c1"># array of shape (N_EPOCH, N_BATCH,*np.shape(W))</span>
</pre></div>
</div>
<p>NOTE: if using a <code class="xref py py-class docutils literal notranslate"><span class="pre">sknet.Queue</span></code> with a given filename, the results
are saved into the .h5 file at each epoch, and the worker data are emptied
for efficiency, in such cases, the same data as described above will be
present in the .h5 file and not in <code class="docutils literal notranslate"><span class="pre">`worker.epoch_data`</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>context: str</strong></dt>
<dd><p class="first last">the name of the set to apply the ops on from the dataset. Typical
example would be :py;data;`”train_set”` or :py:data:‘“valid_set”’</p>
</dd>
<dt><strong>deterministic: bool</strong></dt>
<dd><p class="first last">the state of the network to execute the op in, for example
it is common to set it to <code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code> during training
and <code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code> during testing.</p>
</dd>
<dt><strong>ops: kwargs</strong></dt>
<dd><p class="first last">any desired op or tensor to be executed/monitored. It can be a
op or a couple with the second item being a function with input
<code class="docutils literal notranslate"><span class="pre">`batch,</span> <span class="pre">epoch`</span></code> that should return a boolean value telling if
the op is to be executed at this moment.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="sknet.Worker.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/RandallBalestriero/Sknet/valpha.1/sknet.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sknet.Worker.append" title="Permalink to this definition">¶</a></dt>
<dd><p>given the session output obtained by executing the given list of ops
append the data with the batch values</p>
</dd></dl>

<dl class="method">
<dt id="sknet.Worker.epoch_done">
<code class="descname">epoch_done</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/RandallBalestriero/Sknet/valpha.1/sknet.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sknet.Worker.epoch_done" title="Permalink to this definition">¶</a></dt>
<dd><p>method to be executed after completion of an epoch.
It executes all the needed reset and savings</p>
</dd></dl>

<dl class="method">
<dt id="sknet.Worker.get_ops">
<code class="descname">get_ops</code><span class="sig-paren">(</span><em>batch</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/RandallBalestriero/Sknet/valpha.1/sknet.py"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sknet.Worker.get_ops" title="Permalink to this definition">¶</a></dt>
<dd><p>given a batch index and the current epoch, return the list
of ops to be executed</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="utilities">
<h1>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h1>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../dataset.html" class="btn btn-neutral float-right" title="sknet.dataset" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../base.html" class="btn btn-neutral float-left" title="sknet" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Sknet contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>