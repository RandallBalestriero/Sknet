

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Dataset &mdash; Sknet alpha.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'alpha.1',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Preprocess" href="preprocess.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Sknet
          

          
          </a>

          
            
            
              <div class="version">
                1.8.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dataset</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dataset-format">Dataset format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pre-loaded-datasets">Pre-loaded Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-a-dataset">Adding a dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code-example">Code Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-dataset">Custom dataset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="preprocess.html">Preprocess</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="layer.html">Layer</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/dataset.html"><code class="docutils literal notranslate"><span class="pre">sknet.dataset</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/model.html"><code class="docutils literal notranslate"><span class="pre">sknet.model</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/layer.html"><code class="docutils literal notranslate"><span class="pre">sknet.layer</span></code></a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sknet</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Dataset</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/dataset.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dataset">
<span id="dataloading-label"></span><h1>Dataset<a class="headerlink" href="#dataset" title="Permalink to this headline">¶</a></h1>
<div class="section" id="dataset-format">
<h2>Dataset format<a class="headerlink" href="#dataset-format" title="Permalink to this headline">¶</a></h2>
<p>Each dataset has its own attiributes and specificities. To allow such
flexibility in Python we represent each dataset in a class inheriting from
a <code class="xref py py-mod docutils literal notranslate"><span class="pre">dict</span></code> object. That is, each dataset is a Python dictionnary with
some key attributes s.a. “train_set” or “n_classes”.
We refer to the last section for details and how to create its own dataset.</p>
</div>
<div class="section" id="pre-loaded-datasets">
<h2>Pre-loaded Datasets<a class="headerlink" href="#pre-loaded-datasets" title="Permalink to this headline">¶</a></h2>
<p>Sknet provides comon dataset out-of-the-box in the <a class="reference internal" href="../modules/dataset/dataset.html#module-sknet.dataset" title="sknet.dataset"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sknet.dataset</span></code></a> module as</p>
<ul class="simple">
<li><a class="reference internal" href="../modules/dataset/dataset.html#sknet.dataset.mnist" title="sknet.dataset.mnist"><code class="xref py py-class docutils literal notranslate"><span class="pre">sknet.dataset.mnist</span></code></a></li>
<li><a class="reference internal" href="../modules/dataset/dataset.html#sknet.dataset.fashionmnist" title="sknet.dataset.fashionmnist"><code class="xref py py-class docutils literal notranslate"><span class="pre">sknet.dataset.fashionmnist</span></code></a></li>
<li><a class="reference internal" href="../modules/dataset/dataset.html#sknet.dataset.svhn" title="sknet.dataset.svhn"><code class="xref py py-class docutils literal notranslate"><span class="pre">sknet.dataset.svhn</span></code></a></li>
<li><a class="reference internal" href="../modules/dataset/dataset.html#sknet.dataset.cifar10" title="sknet.dataset.cifar10"><code class="xref py py-class docutils literal notranslate"><span class="pre">sknet.dataset.cifar10</span></code></a></li>
<li><a class="reference internal" href="../modules/dataset/dataset.html#sknet.dataset.cifar100" title="sknet.dataset.cifar100"><code class="xref py py-class docutils literal notranslate"><span class="pre">sknet.dataset.cifar100</span></code></a></li>
</ul>
<p>In order to load the train/valid/test set one simply
calls the load function as in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_set</span><span class="p">,</span><span class="n">valid_set</span><span class="p">,</span><span class="n">test_set</span> <span class="o">=</span> <span class="n">sknet</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">mnist</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
<p>where each set contains first the inputs and then the labels as in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span> <span class="o">=</span> <span class="n">train_set</span>
<span class="n">valid_x</span><span class="p">,</span><span class="n">valid_y</span> <span class="o">=</span> <span class="n">valid_set</span>
<span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span>   <span class="o">=</span> <span class="n">test_set</span>
</pre></div>
</div>
<p>To access the image shape, the data format or additional dataset
specific attributes simply do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mnist_image_shape</span> <span class="o">=</span> <span class="n">sknet</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">mnist</span><span class="o">.</span><span class="n">image_shape</span> <span class="c1">#(1,28,28)</span>
<span class="n">mnist_data_format</span> <span class="o">=</span> <span class="n">sknet</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">mnist</span><span class="o">.</span><span class="n">data_format</span> <span class="c1"># &#39;NCHW&#39;</span>
</pre></div>
</div>
<p>The standard format is ‘NCHW’. But the
library supports transparently the ‘NHWC’.</p>
<p>All the pre-coded dataset will be loaded from the path given by the
environment variable DATASET_PATH. If needs be, the dataset will first
be downloaded into this path prior loading (at first utilisation of
sknet for example). The saved dataset are in compressed format.</p>
</div>
<div class="section" id="adding-a-dataset">
<h2>Adding a dataset<a class="headerlink" href="#adding-a-dataset" title="Permalink to this headline">¶</a></h2>
<p>Each dataset has its correpsonding file in sknet/dataset/dataset_name.py
in which all the attributes and the load function are defined.
To add a dataset, one needs to create a .py file with name being the one
of the dataset. In this file one needs</p>
<blockquote>
<div><ul class="simple">
<li>load function</li>
<li>image_shape, data_format attributes</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="code-example">
<h2>Code Example<a class="headerlink" href="#code-example" title="Permalink to this headline">¶</a></h2>
<p>Running the code _quickstart_data_loading.py</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sknet</span> <span class="kn">import</span> <span class="n">dataset</span>
<span class="kn">from</span> <span class="nn">sknet.utils</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="kn">as</span> <span class="nn">pl</span>

<span class="c1"># Put the dataset functions into a list s.t. dataset_list[0].load() </span>
<span class="c1"># loads the dataset 0</span>
<span class="n">dataset_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">mnist</span><span class="p">(),</span>
                <span class="n">dataset</span><span class="o">.</span><span class="n">fashionmnist</span><span class="p">(),</span>
                <span class="n">dataset</span><span class="o">.</span><span class="n">svhn</span><span class="p">(),</span>
                <span class="n">dataset</span><span class="o">.</span><span class="n">cifar10</span><span class="p">(),</span>
                <span class="n">dataset</span><span class="o">.</span><span class="n">cifar100</span><span class="p">(),</span>
                <span class="n">dataset</span><span class="o">.</span><span class="n">stl10</span><span class="p">()]</span>

<span class="c1"># Loop over the dataset_list to load them (download them if necessary)</span>
<span class="c1"># and display the first 10 images</span>

<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">dataset_list</span><span class="p">:</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

    <span class="c1"># Create the figure</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

    <span class="c1"># Initialize the counter for subplot</span>
    <span class="n">cpt</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># distinguish the cifrar100 case as it has coarse and</span>
    <span class="c1"># fine labels</span>
    <span class="k">if</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;cifar100&#39;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">im</span><span class="p">,</span><span class="n">coarse_label</span><span class="p">,</span><span class="n">fine_label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;train_set&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][:</span><span class="mi">20</span><span class="p">],</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;train_set&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="mi">20</span><span class="p">],</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;train_set&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">][:</span><span class="mi">20</span><span class="p">]):</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">cpt</span><span class="p">)</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;superclasses&#39;</span><span class="p">][</span><span class="n">label</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">][</span><span class="n">label</span><span class="p">])</span>
            <span class="n">plotting</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
            <span class="n">cpt</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">im</span><span class="p">,</span><span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;train_set&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][:</span><span class="mi">20</span><span class="p">],</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;train_set&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="mi">20</span><span class="p">]):</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">cpt</span><span class="p">)</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">][</span><span class="n">label</span><span class="p">])</span>
            <span class="n">plotting</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
            <span class="n">cpt</span><span class="o">+=</span><span class="mi">1</span>

    <span class="c1"># Reduce side margins and save</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./sknet/docs/source/_static/&#39;</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_samples.png&#39;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>will generate the following figure</p>
<img alt="../_images/test_loading.png" src="../_images/test_loading.png" />
<p>running for the first time will produce:</p>
<pre class="literal-block">
Loading mnist
Creating mnist Directory
        Downloading mnist Dataset...
        Done in 2.25
        Opening mnist
Dataset mnist loaded in 3.00 s.
Loading fashionmnist
        Creating Directory
        Downloading fashionmnist Train Images...
        Done in 13.53 s.
        Downloading fashionmnist Train Labels...
        Done in 0.50 s.
        Downloading fashionmnist Test Images...
        Done in 1.87 s.
        Downloading fashionmnist Test Labels...
        Done in 0.31 s.
        Opening fashionmnist
Dataset fashionmnist loaded in 16.54 s.
Loading svhn
        Creating svhn Directory
        Downloading svhn Train Set
        Done in 6.33 s.
        Downloading svhn Test Set
        Done in 12.99 s.
        Opening svhn
Dataset svhn loaded in 21.43 s.
Loading cifar10
        Creating Directory
        Downloading cifar10 Dataset...
        Done in 49.70 s.
        Opening cifar10
Dataset cifar10 loaded in 56.38 s.
Loading cifar100
        Creating cifar100 Directory
        Downloading cifar100 Dataset...
        Done in 13.92
        Opening cifar100
Dataset cifar100 loaded in 16.16 s.
Loading stl10
        Creating stl10 Directory
        Downloading stl10 Dataset...
        Done in 64.77 s.
        Opening stl10
Dataset stl10 loaded in 102.04 s.

</pre>
<p>running for the next times will produce:</p>
<pre class="literal-block">
Loading mnist
        Opening mnist
Dataset mnist loaded in 0.69 s.
Loading fashionmnist
        Opening fashionmnist
Dataset fashionmnist loaded in 0.29 s.
Loading svhn
        Opening svhn
Dataset svhn loaded in 2.05 s.
Loading cifar10
        Opening cifar10
Dataset cifar10 loaded in 6.60 s.
Loading cifar100
        Opening cifar100
Dataset cifar100 loaded in 2.21 s.
Loading stl10
        Opening stl10
Dataset stl10 loaded in 37.29 s.

</pre>
</div>
<div class="section" id="custom-dataset">
<h2>Custom dataset<a class="headerlink" href="#custom-dataset" title="Permalink to this headline">¶</a></h2>
<p>You can simply use the <code class="xref py py-mod docutils literal notranslate"><span class="pre">dataset.custom</span></code> and give (at least) the training set as well as the data_format and the number of classes.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="preprocess.html" class="btn btn-neutral float-right" title="Preprocess" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Sknet contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>